# Fail2ban filter for common HTTP attack/scan patterns on nginx
# This is a template to be copied to /etc/fail2ban/filter.d/nginx-attack.conf on the server.

[Definition]
# Match obvious scanners and exploitation attempts in nginx access.log
# Examples: requests to .env, .git, wp-login, xmlrpc, phpMyAdmin, etc.
failregex = ^<HOST> -.*"(GET|POST|HEAD|OPTIONS) .*(\.env|\.git/|wp-login\.php|wp-admin/|xmlrpc\.php|/phpMyAdmin/|/phpmyadmin/|/manager/html|/console/login|/\.vscode/|/\.idea/)"

# Optionally: treat repeated 4xx on suspicious paths as attacks
#failregex = ^<HOST> -.*"(GET|POST|HEAD|OPTIONS) .*(\.env|\.git/|wp-login\.php|wp-admin/|xmlrpc\.php|/phpMyAdmin/|/phpmyadmin/)" [0-9]{3}

ignoreregex =
